<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›£è¦–å™¨ç³»çµ±æ¸¬è©¦é </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft JhengHei', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: white; text-align: center; margin-bottom: 30px; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .test-card { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .test-card h2 { color: #333; margin-bottom: 15px; }
        .test-card p { color: #666; margin-bottom: 15px; }
        .test-btn { display: inline-block; padding: 10px 20px; background: #667eea; color: white; text-decoration: none; border-radius: 5px; margin-right: 10px; margin-bottom: 10px; }
        .test-btn:hover { background: #5a6fd8; }
        .status { padding: 10px; border-radius: 5px; margin-top: 10px; }
        .status.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status.warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .status.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-test-tube"></i> ç›£è¦–å™¨ç³»çµ±æ¸¬è©¦é </h1>
        
        <div class="test-grid">
            <div class="test-card">
                <h2><i class="fas fa-highway"></i> åœ‹é“ç›£è¦–å™¨ç³»çµ±</h2>
                <p>æ¸¬è©¦åœ‹é“ç›£è¦–å™¨çš„é›™é‡è³‡æ–™ä¾†æºåŠŸèƒ½ï¼ŒåŒ…å«TDX APIå’Œå‚™æ´XML APIã€‚</p>
                <a href="highway.html" class="test-btn" target="_blank">
                    <i class="fas fa-external-link-alt"></i> é–‹å•Ÿåœ‹é“ç³»çµ±
                </a>
                <div class="status success">
                    <i class="fas fa-check-circle"></i> 
                    <strong>åŠŸèƒ½ç‰¹è‰²ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>TDX API + å‚™æ´ XML API</li>
                        <li>åœ‹é“ã€ç¸£å¸‚ã€æ–¹å‘ç¯©é¸</li>
                        <li>è³‡æ–™ä¾†æºæ¨™ç¤º</li>
                        <li>å³æ™‚å½±åƒé è¦½</li>
                    </ul>
                </div>
            </div>

            <div class="test-card">
                <h2><i class="fas fa-road"></i> é“è·¯ç›£è¦–å™¨ç³»çµ±</h2>
                <p>æ¸¬è©¦çœé“ç›£è¦–å™¨çš„é›™é‡è³‡æ–™ä¾†æºåŠŸèƒ½ï¼ŒåŒ…å«TDX APIå’Œå‚™æ´XML APIã€‚</p>
                <a href="road.html" class="test-btn" target="_blank">
                    <i class="fas fa-external-link-alt"></i> é–‹å•Ÿé“è·¯ç³»çµ±
                </a>
                <div class="status success">
                    <i class="fas fa-check-circle"></i> 
                    <strong>åŠŸèƒ½ç‰¹è‰²ï¼š</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>TDX API + å‚™æ´ XML API</li>
                        <li>ç¸£å¸‚ã€è·¯ç·šåç¨±ç¯©é¸</li>
                        <li>è³‡æ–™ä¾†æºæ¨™ç¤º</li>
                        <li>æ™ºæ…§åº§æ¨™è½‰æ›</li>
                    </ul>
                </div>
            </div>

            <div class="test-card">
                <h2><i class="fas fa-cog"></i> API æ¸¬è©¦å·¥å…·</h2>
                <p>æ¸¬è©¦å„ç¨®APIé€£ç·šç‹€æ³å’Œè³‡æ–™æ ¼å¼ã€‚</p>
                <button class="test-btn" onclick="testTDXAPI()">
                    <i class="fas fa-database"></i> æ¸¬è©¦ TDX API
                </button>
                <button class="test-btn" onclick="testXMLAPI()">
                    <i class="fas fa-file-code"></i> æ¸¬è©¦ XML API
                </button>
                <a href="debug-classification.html" class="test-btn" target="_blank" style="display: inline-block;">
                    <i class="fas fa-search"></i> ç›£æ¸¬ç«™åˆ†é¡èª¿è©¦
                </a>
                <a href="coordinate-test.html" class="test-btn" target="_blank" style="display: inline-block;">
                    <i class="fas fa-map-marked-alt"></i> åº§æ¨™è½‰æ›æ¸¬è©¦
                </a>
                <a href="city-validation.html" class="test-btn" target="_blank" style="display: inline-block;">
                    <i class="fas fa-map-check"></i> å…¨ç³»çµ±ç¸£å¸‚é©—è­‰
                </a>
                <a href="quick-check.html" class="test-btn" target="_blank" style="display: inline-block;">
                    <i class="fas fa-tachometer-alt"></i> ç¸£å¸‚å¿«é€Ÿæª¢æŸ¥
                </a>
                <div id="apiTestResult" class="status" style="display: none;"></div>
            </div></div>

            <div class="test-card">
                <h2><i class="fas fa-bug"></i> å•é¡Œè§£æ±º</h2>
                <p>é‡å°ç›£æ¸¬ç«™åˆ†é¡å•é¡Œçš„ä¿®æ­£èªªæ˜</p>
                <div class="status warning">
                    <strong>å·²ä¿®æ­£å•é¡Œï¼š</strong><br>
                    â€¢ æ°´åˆ©ç½²ç›£æ¸¬ç«™ (ID: 007d029e-2adc-4012-8602-7d69796cbcc8)<br>
                    â€¢ é›†æˆæ©‹-è§€éŸ³å‘æºªæ’æ°´ ç¾å·²æ­£ç¢ºæ­¸é¡ç‚ºæ°´è³‡æºç›£æ§<br>
                    â€¢ åœŸçŸ³æµç³»çµ±å·²éæ¿¾æ‰æ’æ°´ã€æ©‹æ¢ç­‰æ°´åˆ©è¨­æ–½
                </div>
                <div class="status success" style="margin-top: 10px;">
                    <strong>åˆ†é¡é‚è¼¯ï¼š</strong><br>
                    â€¢ ğŸ’§ æ°´è³‡æºï¼šæ’æ°´ã€æ©‹æ¢ã€å °å£©ã€æ²³å·ç›£æ§<br>
                    â€¢ ğŸ”ï¸ åœŸçŸ³æµï¼šå±±å€ã€å¡åœ°ã€å´©å¡Œè§€æ¸¬ç«™<br>
                    â€¢ ğŸ›£ï¸ äº¤é€šï¼šåœ‹é“ã€çœé“è·¯æ³ç›£æ§
                </div>
            </div>

            <div class="test-card">
                <h2><i class="fas fa-info-circle"></i> ç³»çµ±è³‡è¨Š</h2>
                <p>ç•¶å‰ç³»çµ±é…ç½®å’Œç‹€æ…‹è³‡è¨Šã€‚</p>
                <div class="status warning">
                    <strong>è³‡æ–™ä¾†æºï¼š</strong><br>
                    â€¢ TDX API: äº¤é€šéƒ¨é‹è¼¸è³‡æ–™æµé€šæœå‹™<br>
                    â€¢ åœ‹é“ XML: tisvcloud.freeway.gov.tw<br>
                    â€¢ çœé“ XML: thb.gov.tw
                </div>
                <div class="status success" style="margin-top: 10px;">
                    <strong>å®¹éŒ¯æ©Ÿåˆ¶ï¼š</strong><br>
                    â€¢ ä¸»è¦APIå¤±æ•—æ™‚è‡ªå‹•åˆ‡æ›å‚™æ´<br>
                    â€¢ é‡è¤‡è³‡æ–™è‡ªå‹•å»é™¤<br>
                    â€¢ å½±åƒè¼‰å…¥éŒ¯èª¤è™•ç†
                </div>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="tdx-api.js"></script>
    <script>
        async function testTDXAPI() {
            const result = document.getElementById('apiTestResult');
            result.style.display = 'block';
            result.className = 'status warning';
            result.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ­£åœ¨æ¸¬è©¦ TDX API...';
            
            try {
                const response = await tdxApi.fetchCCTV('/v2/Road/Traffic/CCTV/Freeway?$top=5&$format=JSON');
                result.className = 'status success';
                result.innerHTML = `
                    <i class="fas fa-check-circle"></i> <strong>TDX API æ¸¬è©¦æˆåŠŸ</strong><br>
                    è³‡æ–™æ ¼å¼: ${Array.isArray(response) ? 'é™£åˆ—' : (response.CCTVs ? 'CCTVsåŒ…è£¹' : 'å…¶ä»–')}<br>
                    è³‡æ–™ç­†æ•¸: ${response.CCTVs ? response.CCTVs.length : (Array.isArray(response) ? response.length : 'æœªçŸ¥')}
                `;
            } catch (error) {
                result.className = 'status error';
                result.innerHTML = `
                    <i class="fas fa-times-circle"></i> <strong>TDX API æ¸¬è©¦å¤±æ•—</strong><br>
                    éŒ¯èª¤è¨Šæ¯: ${error.message}
                `;
            }
        }

        async function testXMLAPI() {
            const result = document.getElementById('apiTestResult');
            result.style.display = 'block';
            result.className = 'status warning';
            result.innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ­£åœ¨æ¸¬è©¦ XML API...';
            
            try {
                const response = await fetch('https://tisvcloud.freeway.gov.tw/history/motc20/CCTV.xml');
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
                const ccttvs = xmlDoc.querySelectorAll('CCTV');
                
                result.className = 'status success';
                result.innerHTML = `
                    <i class="fas fa-check-circle"></i> <strong>XML API æ¸¬è©¦æˆåŠŸ</strong><br>
                    HTTP ç‹€æ…‹: ${response.status}<br>
                    è³‡æ–™ç­†æ•¸: ${ccttvs.length}
                `;
            } catch (error) {
                result.className = 'status error';
                result.innerHTML = `
                    <i class="fas fa-times-circle"></i> <strong>XML API æ¸¬è©¦å¤±æ•—</strong><br>
                    éŒ¯èª¤è¨Šæ¯: ${error.message}
                `;
            }
        }
    </script>
</body>
</html>