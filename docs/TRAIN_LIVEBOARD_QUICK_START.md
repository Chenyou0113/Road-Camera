# 台鐵即時看板 - 快速開始指南

## 🚀 5 分鐘快速上手

### 步驟 1: 打開頁面
```
1. 在瀏覽器中打開 train-liveboard.html
2. 看到「台鐵即時到離站看板」的標題
```

### 步驟 2: 選擇車站
```
1. 在「路線」下拉選單中選擇路線
   例如: 西部幹線、東部幹線等

2. 在「車站」下拉選單中選擇具體車站
   例如: 台北、基隆、高雄等

3. 點擊「查詢看板」按鈕
```

### 步驟 3: 查看列車資訊
```
頁面會顯示:
- 🚆 車次號碼
- 🔴 車種 (自強/普悠瑪/區間等)
- ⬇️ 方向 (南下/北上)
- 🛤️ 終點站
- ⏰ 預計到站時間
- ⏰ 預計離站時間
- ✅ 狀態 (準點/誤點等)
```

### 步驟 4: 使用篩選功能
```
在表格上方有 4 個篩選按鈕:

📋 全部     - 顯示所有列車
⬇️ 到站     - 只顯示即將到站的列車
⬆️ 離站     - 只顯示即將離站的列車
⚠️ 延誤     - 只顯示延誤列車

點擊任一按鈕即可篩選
```

### 步驟 5: 使用排序功能
```
在表格上方「排序」下拉選單中選擇:

時間順序   - 按到站/離站時間排序 (默認)
車次排序   - 按車次號碼排序
車種分類   - 按車種分類排序
延誤排序   - 最延誤的列車優先
```

---

## 📊 關鍵按鈕和功能

### 控制面板

```
┌─────────────────────────────────────────────────────────────┐
│ [全部] [到站] [離站] [延誤]              [排序 ▼] [匯出]     │
└─────────────────────────────────────────────────────────────┘

按鈕說明:
- [全部/到站/離站/延誤] = 篩選列車
- [排序 ▼] = 選擇排序方式
- [匯出] = 下載 CSV 檔案
- [🔄] = 立即刷新 (在時間戳旁)
```

### 刷新機制

```
自動更新:
- 查詢後自動每 2 分鐘更新一次
- 保持目前篩選和排序狀態

手動刷新:
- 點擊時間戳旁的刷新圖示 🔄
- 立即重新載入最新資料
```

---

## 🎨 顏色說明

### 列車狀態顏色

```
🟢 準點 (0-5分)
   ✅ 正常運行，按時到達

🔵 早到 (早於預定時間)
   ⚡ 列車提前到達

🟡 輕微延誤 (6-10分)
   ⚠️ 稍微延誤，注意行程

🔴 延誤 (11-30分)
   ⚠️ 明顯延誤，可能影響銜接

🔴 嚴重延誤 (>30分)
   🚨 嚴重延誤，需要改變計劃

⚫ 停駛
   ❌ 該班列車停駛
```

### 車種顏色

```
🔴 自強號 (Tze-Chiang)
   快速長距列車

🟠 普悠瑪 (Puyuma)
   高速表定列車

🟠 莒光號 (Chu-Kuang)
   中速長距列車

🔵 區間車 (Local)
   短距停靠多站列車

🔴 區間快 (Fast Local)
   區間快速列車
```

---

## 💡 使用技巧

### 技巧 1: 快速找到延誤列車
```
1. 點擊「延誤」篩選按鈕
2. 點擊「排序」選單選擇「延誤排序」
3. 最延誤的列車會顯示在最上面
```

### 技巧 2: 查看即將開車的列車
```
1. 點擊「離站」篩選按鈕
2. 按「時間順序」排序
3. 最快要開車的列車在最上面
```

### 技巧 3: 按車種篩選
```
1. 先篩選其他條件
2. 使用「車種分類」排序
3. 所有車種會按代碼分組
```

### 技巧 4: 導出資料進行分析
```
1. 查詢完成後點擊「匯出」按鈕
2. 下載 CSV 檔案
3. 在 Excel 或 Google Sheets 中開啟
4. 進行進一步分析 (統計、製表等)
```

### 技巧 5: 監控特定路線
```
1. 選擇路線中的特定線路 (西部/東部等)
2. 選擇多個車站進行查詢
3. 比較不同車站的列車情況
```

---

## 📱 深色模式

### 啟用深色模式
```
1. 找到頁面右上角的月亮圖示 🌙
2. 點擊切換到深色模式
3. 再點一次回到光亮模式

深色模式特色:
- 🌙 護眼設計
- 🔋 省電 (OLED 螢幕)
- 🎨 現代感
```

---

## 📊 統計面板說明

頁面上方顯示 4 個統計數字:

```
┌──────────────┬──────────────┬──────────────┬──────────────┐
│ 列車總數      │ 即將到站      │ 即將離站      │ 延誤列車      │
│   Total      │   Arrivals   │  Departures  │   Delayed    │
├──────────────┼──────────────┼──────────────┼──────────────┤
│     48       │      12      │      24      │      3       │
└──────────────┴──────────────┴──────────────┴──────────────┘

解讀:
- 列車總數 48 班: 這個時段共有 48 班列車經過此站
- 即將到站 12 班: 未來 30 分鐘內有 12 班列車將抵達
- 即將離站 24 班: 未來 30 分鐘內有 24 班列車將離開
- 延誤列車 3 班: 有 3 班列車延誤超過 5 分鐘
```

---

## 🔔 通知系統

### 自動提示

```
延誤警示:
- 當有列車延誤 > 15 分鐘時自動顯示
- Toast 提示會在右下角彈出
- 包含延誤列車數量和詳情

嚴重警示:
- 當有列車延誤 > 30 分鐘時
- 會顯示「⚠️ 嚴重警示」
- 提醒用戶注意
```

### 啟用瀏覽器通知

```
首次使用時瀏覽器會詢問:
「是否允許通知？」

選擇「允許」:
✓ 可以在後台接收通知
✓ 即使最小化也能收到警示

選擇「不允許」:
✗ 只能看 Toast 提示
✗ 需要保持頁面打開
```

---

## ⏰ 自動更新說明

### 更新流程

```
查詢看板 (User 點擊「查詢看板」)
    ↓
首次載入資料 (立即)
    ↓
顯示在表格中
    ↓
啟動 120 秒計時器
    ↓
等待 2 分鐘...
    ↓
自動重新載入最新資料
    ↓
更新表格 (保留篩選/排序設定)
    ↓
更新時間戳
    ↓
檢測異常並顯示警示
    ↓
重複上述流程...

⏹️ 停止更新:
- 關閉頁面
- 選擇其他車站並查詢
- 刷新頁面
```

---

## 🐛 常見問題

### Q1: 為什麼看不到某班列車？
```
A: 列車可能是:
   1. 已經離站 (過了 30 分鐘時間窗)
   2. 尚未發車 (超過 30 分鐘後)
   3. 被篩選條件過濾掉了

解決方法:
- 檢查篩選按鈕是否正確
- 選擇「全部」查看所有列車
- 查詢另一個時間段的看板
```

### Q2: 資料多久更新一次？
```
A: 自動更新間隔: 2 分鐘

說明:
- 首次查詢後自動更新
- 每 2 分鐘刷新一次
- 可點擊刷新圖示立即更新
- 時間戳會實時顯示
```

### Q3: 為什麼延誤時間是負數？
```
A: 負數表示列車早到

例如:
- "-5分" = 比預定時間早 5 分鐘到達
- "-10分" = 比預定時間早 10 分鐘到達

這種情況很少見，但會標示為「早到」狀態
```

### Q4: 如何導出資料？
```
A: 按以下步驟:

1. 查詢完成後點擊「匯出」按鈕
2. 系統會下載 CSV 檔案
3. 檔案名稱格式: train_board_YYYY-MM-DD.csv
4. 在 Excel 或 Google Sheets 中開啟

CSV 包含欄位:
- 車次
- 車種
- 方向
- 終點站
- 預計到站
- 預計離站
- 延誤(分)
- 狀態
```

### Q5: 為什麼某些功能不能用？
```
A: 可能原因:

1. 路線/車站未正確選擇
   → 檢查下拉選單是否有選擇

2. 尚未查詢看板
   → 必須點擊「查詢看板」才能使用其他功能

3. 瀏覽器不支援
   → 建議使用 Chrome/Firefox/Safari 最新版本

4. 網路連線問題
   → 檢查網路是否正常
   → 點擊「重新載入」重試
```

---

## 🎯 不同使用場景

### 場景 1: 快速查看某班列車的狀態

```
步驟:
1. 查詢車站看板
2. 使用「車次排序」找到該班列車
3. 或直接掃描表格找車次號碼
4. 查看狀態欄位 (準點/延誤/停駛等)
```

### 場景 2: 監控是否有列車延誤

```
步驟:
1. 查詢看板
2. 查看「延誤列車」統計數字
3. 如果 > 0，點擊「延誤」篩選按鈕
4. 查看具體延誤的列車和分鐘數
5. 系統會自動顯示提醒
```

### 場景 3: 規劃乘車時間

```
步驟:
1. 查詢起始車站看板
2. 點擊「到站」篩選按鈕
3. 按「時間順序」查看最近的列車
4. 選擇適合的班次和終點站
5. 記下預計到站/離站時間
```

### 場景 4: 分析延誤原因 (數據分析)

```
步驟:
1. 查詢多個時間段的看板
2. 每次都「匯出」為 CSV
3. 在 Excel 中合併資料
4. 製作圖表分析延誤模式
5. 尋找規律和原因
```

---

## 🔧 技術細節

### 更新時間顯示格式

```
HH:MM:SS (24小時制)

例如:
23:47:30 = 晚上 11 時 47 分 30 秒
09:15:45 = 早上 9 時 15 分 45 秒
```

### 列車編號格式

```
車次號碼 = 數字 (1-5 碼)

例如:
447    = 自強號
3786   = 區間車
256    = 莒光號

編號規則:
- 1-999: 特定路線列車
- 1000-1999: 西部幹線列車
- 2000-2999: 西部海線列車
- 3000-3999: 中部列車
- 4000-4999: 南部列車
- 5000-5999: 屏東南迴線列車
- 6000-6999: 東部幹線列車
- 7000-7999: 支線列車
```

### API 更新頻率限制

```
TDX API 限制:
- 每秒調用次數: 無限制
- 但列車資訊更新頻率: 約 1-2 分鐘
- 我們設置為 2 分鐘自動更新

這表示:
✓ 更頻繁更新不會有新資料
✓ 2 分鐘一次是最佳平衡
✓ 避免不必要的 API 調用
```

---

## 📞 需要幫助？

### 提交回報

如果發現問題或有建議，請提供:

1. **問題描述**: 發生了什麼問題？
2. **重現步驟**: 如何重現這個問題？
3. **預期行為**: 應該發生什麼？
4. **實際行為**: 實際發生什麼？
5. **環境信息**:
   - 瀏覽器: (Chrome/Firefox/Safari/Edge)
   - 版本: (版本號)
   - 作業系統: (Windows/Mac/Linux)

---

**快速參考卡**

```
查詢看板:
1. 選擇路線 → 選擇車站 → 查詢

篩選列車:
- 全部 / 到站 / 離站 / 延誤

排序列車:
- 時間 / 車次 / 車種 / 延誤

功能:
- 立即刷新 🔄
- 匯出資料 📥
- 深色模式 🌙

自動更新:
- 每 2 分鐘一次
- 保留篩選設定
```

---

版本: 1.0  
最後更新: 2025-11-20
