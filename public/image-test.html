<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>監視器影像測試</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-image { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
        img { max-width: 400px; height: 200px; object-fit: cover; }
        .info { color: #666; font-size: 0.9rem; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>國道監視器影像測試</h1>
    
    <div class="test-image">
        <h3>測試影像 1 (原始URL)</h3>
        <img src="https://cctvn.freeway.gov.tw/abs2mjpg/bmjpg?camera=10000" 
             alt="測試影像" 
             onerror="this.nextElementSibling.textContent = '原始URL載入失敗'">
        <div class="info">原始URL格式載入狀態</div>
    </div>
    
    <div class="test-image">
        <h3>測試影像 2 (MJPG格式)</h3>
        <img src="https://cctvn.freeway.gov.tw/abs2mjpg/mjpg?camera=10000" 
             alt="測試影像" 
             onerror="this.nextElementSibling.textContent = 'MJPG格式載入失敗'">
        <div class="info">MJPG格式載入狀態</div>
    </div>
    
    <div class="test-image">
        <h3>測試影像 3 (JPG格式)</h3>
        <img src="https://cctvn.freeway.gov.tw/abs2mjpg/jpg?camera=10000" 
             alt="測試影像" 
             onerror="this.nextElementSibling.textContent = 'JPG格式載入失敗'">
        <div class="info">JPG格式載入狀態</div>
    </div>

    <div class="test-image">
        <h3>測試影像 4 (靜態截圖)</h3>
        <img src="https://cctvn.freeway.gov.tw/cctvn/snapshot?camera=10000" 
             alt="測試影像" 
             onerror="this.nextElementSibling.textContent = '靜態截圖載入失敗'">
        <div class="info">靜態截圖載入狀態</div>
    </div>

    <script>
        // 檢測影像載入狀態
        document.querySelectorAll('img').forEach((img, index) => {
            img.onload = function() {
                this.nextElementSibling.textContent = '✅ 載入成功';
                this.nextElementSibling.style.color = 'green';
            };
            
            img.onerror = function() {
                this.nextElementSibling.textContent = '❌ 載入失敗 - 可能是CORS限制或URL格式問題';
                this.nextElementSibling.style.color = 'red';
                
                // 嘗試加載靜態替代圖片
                this.src = 'data:image/svg+xml,<svg width="400" height="200" xmlns="http://www.w3.org/2000/svg"><rect width="400" height="200" fill="%23f0f0f0"/><text x="50%" y="50%" font-family="Arial" font-size="16" fill="%23999" text-anchor="middle" dy=".3em">影像載入失敗</text></svg>';
            };
        });

        // 顯示測試資訊
        setTimeout(() => {
            console.log('影像載入測試完成');
            const results = Array.from(document.querySelectorAll('.info')).map(el => el.textContent);
            console.log('測試結果:', results);
        }, 5000);
    </script>
</body>
</html>