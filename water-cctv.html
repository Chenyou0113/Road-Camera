<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>水利署 CCTV 監控站系統 | 即時影像監控</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="assets/modern-theme.css">
    <link rel="stylesheet" href="assets/dark-mode.css">
    <style>
        :root {
            --primary-blue: #2c5aa0;
            --accent-cyan: #00bcd4;
            --success-green: #4caf50;
            --warning-orange: #ff9800;
            --danger-red: #f44336;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #87ceeb 0%, #add8e6 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .header-content {
            flex: 1;
        }

        .back-button {
            padding: 10px 20px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            text-decoration: none;
            color: var(--primary-blue);
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .back-button:hover {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
            transform: translateX(-3px);
        }

        h1 {
            margin: 0;
            color: var(--primary-blue);
            font-size: 2em;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        h1 i {
            color: var(--accent-cyan);
            font-size: 1.2em;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
            width: 100%;
        }

        .stat-card {
            background: linear-gradient(135deg, #87ceeb 0%, #add8e6 100%);
            color: #333;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-card i {
            font-size: 2em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .controls {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-group label {
            font-weight: 600;
            color: #333;
            font-size: 0.9em;
        }

        select, input[type="text"] {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            background: white;
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 0 3px rgba(0, 188, 212, 0.1);
        }

        .search-box {
            position: relative;
        }

        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .search-box input {
            width: 100%;
            padding-right: 45px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-cyan));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(44, 90, 160, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .panel-title {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--primary-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #map {
            height: 500px;
            border-radius: 12px;
            overflow: hidden;
        }

        .station-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            max-height: 600px;
            overflow-y: auto;
            padding: 10px;
        }

        .station-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .station-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            border-color: var(--accent-cyan);
        }

        .station-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 12px;
            background: #f0f0f0;
        }

        .station-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .station-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            font-size: 0.9em;
            color: #666;
        }

        .station-info span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .station-info i {
            width: 20px;
            color: var(--accent-cyan);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .status-active {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-inactive {
            background: #ffebee;
            color: #c62828;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading i {
            font-size: 3em;
            color: var(--accent-cyan);
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s ease;
            color: #333;
        }

        .modal-content p {
            color: #333;
            margin: 8px 0;
            line-height: 1.6;
        }

        .modal-content strong {
            color: #2c5aa0;
            font-weight: 600;
        }

        .modal-content h2 {
            color: #2c5aa0 !important;
        }

        .modal-content h3 {
            color: #555 !important;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-modal {
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: var(--danger-red);
        }

        .modal-image {
            width: 100%;
            border-radius: 12px;
            margin: 20px 0;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 1.5em;
            }

            .station-grid {
                grid-template-columns: 1fr;
            }
        }

        .view-toggle {
            display: flex;
            gap: 10px;
        }

        .view-btn {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .view-btn.active {
            background: var(--accent-cyan);
            color: white;
            border-color: var(--accent-cyan);
        }

        .view-btn:hover {
            border-color: var(--accent-cyan);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>
                    <i class="fas fa-video"></i>
                    水利署 CCTV 監控站系統
                </h1>
            </div>
            <a href="index.html" class="back-button">
                <i class="fas fa-arrow-left"></i>
                返回
            </a>
        </header>
            <div class="stats-bar">
                <div class="stat-card">
                    <i class="fas fa-broadcast-tower"></i>
                    <div class="stat-value" id="totalStations">0</div>
                    <div class="stat-label">總監控站數</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle"></i>
                    <div class="stat-value" id="activeStations">0</div>
                    <div class="stat-label">運作中</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-water"></i>
                    <div class="stat-value" id="basinCount">0</div>
                    <div class="stat-label">流域數</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-filter"></i>
                    <div class="stat-value" id="filteredCount">0</div>
                    <div class="stat-label">目前顯示</div>
                </div>
            </div>
        </header>

        <div class="controls">
            <div class="filter-row">
                <div class="filter-group">
                    <label><i class="fas fa-map-marker-alt"></i> 縣市</label>
                    <select id="cityFilter">
                        <option value="">全部縣市</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label><i class="fas fa-water"></i> 流域</label>
                    <select id="basinFilter">
                        <option value="">全部流域</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label><i class="fas fa-map-pin"></i> 行政區</label>
                    <select id="districtFilter">
                        <option value="">全部行政區</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label><i class="fas fa-stream"></i> 支流</label>
                    <select id="tributaryFilter">
                        <option value="">全部支流</option>
                    </select>
                </div>
            </div>
            <div class="filter-row">
                <div class="filter-group search-box">
                    <label><i class="fas fa-search"></i> 搜尋</label>
                    <input type="text" id="searchBox" placeholder="輸入站名、地點或流域名稱...">
                    <i class="fas fa-search"></i>
                </div>
            </div>
            <div class="button-group">
                <button class="btn btn-primary" onclick="applyFilters()">
                    <i class="fas fa-filter"></i> 套用篩選
                </button>
                <button class="btn btn-secondary" onclick="resetFilters()">
                    <i class="fas fa-redo"></i> 重置
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-map"></i>
                        地圖定位
                    </div>
                </div>
                <div id="map"></div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <i class="fas fa-th-large"></i>
                        監控站列表
                    </div>
                    <div class="view-toggle">
                        <button class="view-btn active" onclick="setView('grid')">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="view-btn" onclick="setView('list')">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>
                <div id="stationList" class="station-grid">
                    <div class="loading">
                        <i class="fas fa-spinner"></i>
                        <p>載入監控站資料中...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 詳細資訊 Modal -->
    <div id="stationModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="assets/water-cctv-manager.js"></script>
    <script src="assets/water-cctv-data.js"></script>
    <script src="assets/dark-mode.js"></script>
    <script>
        // 全域變數
        let map;
        let markers = [];
        let currentView = 'grid';

        // 載入資料
        async function loadData() {
            try {
                // 使用 JavaScript 模組資料（避免 JSON 檔案過大問題）
                const stationsData = window.waterCCTVStationsData || [];
                
                if (stationsData.length === 0) {
                    throw new Error('資料檔案未正確載入');
                }
                
                await waterCCTVManager.loadStations(stationsData);
                
                initializeFilters();
                updateStatistics();
                initializeMap();
                displayStations();
            } catch (error) {
                console.error('載入資料失敗:', error);
                document.getElementById('stationList').innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #f44336;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 3em;"></i>
                        <p>資料載入失敗，請重新整理頁面</p>
                    </div>
                `;
            }
        }

        // 初始化篩選器
        function initializeFilters() {
            // 縣市
            const cities = waterCCTVManager.getCities();
            const citySelect = document.getElementById('cityFilter');
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });

            // 流域
            const basins = waterCCTVManager.getBasins();
            const basinSelect = document.getElementById('basinFilter');
            basins.forEach(basin => {
                const option = document.createElement('option');
                option.value = basin;
                option.textContent = basin;
                basinSelect.appendChild(option);
            });

            // 縣市變更時更新行政區
            citySelect.addEventListener('change', () => {
                updateDistrictFilter();
            });

            // 流域變更時更新支流
            basinSelect.addEventListener('change', () => {
                updateTributaryFilter();
            });

            // 搜尋框即時搜尋
            document.getElementById('searchBox').addEventListener('input', (e) => {
                waterCCTVManager.search(e.target.value);
                displayStations();
                updateMapMarkers();
                updateStatistics();
            });
        }

        // 更新行政區篩選器
        function updateDistrictFilter() {
            const city = document.getElementById('cityFilter').value;
            const districts = waterCCTVManager.getDistricts(city);
            const districtSelect = document.getElementById('districtFilter');
            
            districtSelect.innerHTML = '<option value="">全部行政區</option>';
            districts.forEach(district => {
                const option = document.createElement('option');
                option.value = district;
                option.textContent = district;
                districtSelect.appendChild(option);
            });
        }

        // 更新支流篩選器
        function updateTributaryFilter() {
            const basin = document.getElementById('basinFilter').value;
            const tributaries = waterCCTVManager.getTributaries(basin);
            const tributarySelect = document.getElementById('tributaryFilter');
            
            tributarySelect.innerHTML = '<option value="">全部支流</option>';
            tributaries.forEach(tributary => {
                const option = document.createElement('option');
                option.value = tributary;
                option.textContent = tributary;
                tributarySelect.appendChild(option);
            });
        }

        // 套用篩選
        function applyFilters() {
            const filters = {
                city: document.getElementById('cityFilter').value,
                basin: document.getElementById('basinFilter').value,
                district: document.getElementById('districtFilter').value,
                tributary: document.getElementById('tributaryFilter').value,
                status: '1'
            };
            
            waterCCTVManager.applyFilters(filters);
            displayStations();
            updateMapMarkers();
            updateStatistics();
        }

        // 重置篩選
        function resetFilters() {
            document.getElementById('cityFilter').value = '';
            document.getElementById('basinFilter').value = '';
            document.getElementById('districtFilter').value = '';
            document.getElementById('tributaryFilter').value = '';
            document.getElementById('searchBox').value = '';
            
            waterCCTVManager.resetFilters();
            updateDistrictFilter();
            updateTributaryFilter();
            displayStations();
            updateMapMarkers();
            updateStatistics();
        }

        // 更新統計資訊
        function updateStatistics() {
            const stats = waterCCTVManager.getStatistics();
            document.getElementById('totalStations').textContent = stats.total;
            document.getElementById('activeStations').textContent = stats.active;
            document.getElementById('basinCount').textContent = Object.keys(stats.byBasin).length;
            document.getElementById('filteredCount').textContent = stats.filtered;
        }

        // 初始化地圖
        function initializeMap() {
            map = L.map('map').setView([23.5, 121], 7);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
            
            updateMapMarkers();
        }

        // 更新地圖標記
        function updateMapMarkers() {
            // 清除現有標記
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];
            
            const mapData = waterCCTVManager.getMapMarkers();
            
            mapData.forEach(station => {
                const marker = L.marker([station.lat, station.lng])
                    .bindPopup(`
                        <div style="min-width: 200px;">
                            <h3 style="margin: 0 0 10px 0; color: #2c5aa0;">${station.name}</h3>
                            <p><strong>縣市：</strong>${station.city}</p>
                            <p><strong>行政區：</strong>${station.district}</p>
                            <p><strong>流域：</strong>${station.basin || '未分類'}</p>
                            <button onclick="showStationDetail('${station.id}')" 
                                    style="width: 100%; padding: 8px; background: #00bcd4; 
                                           color: white; border: none; border-radius: 5px; 
                                           cursor: pointer; margin-top: 10px;">
                                查看詳細資訊
                            </button>
                        </div>
                    `)
                    .addTo(map);
                
                markers.push(marker);
            });
        }

        // 取得欄位值（支援新舊格式）
        function getField(station, newField, oldField) {
            return station[newField] || station[oldField] || '';
        }

        // 顯示監控站列表
        function displayStations() {
            const stations = waterCCTVManager.getFilteredStations();
            const container = document.getElementById('stationList');
            
            if (stations.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #999; grid-column: 1/-1;">
                        <i class="fas fa-inbox" style="font-size: 3em; margin-bottom: 15px;"></i>
                        <p>找不到符合條件的監控站</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = stations.map(station => {
                const cameraId = getField(station, 'CameraID', 'cameraid');
                const imageUrl = getField(station, 'ImageURL', 'imageurl');
                const cameraName = getField(station, 'CameraName', 'cameraname');
                const city = getField(station, 'CountiesAndCitiesWhereTheMonitoringPointsAreLocated', 'countiesandcitieswherethemonitoringpointsarelocated');
                const district = getField(station, 'AdministrativeDistrictWhereTheMonitoringPointIsLocated', 'administrativedistrictwherethemonitoringpointislocated');
                const basin = getField(station, 'BasinName', 'basinname');
                const tributary = getField(station, 'TRIBUTARY', 'tributary');
                const status = getField(station, 'Status', 'status');
                
                return `
                    <div class="station-card" onclick="showStationDetail('${cameraId}')">
                        <img src="${imageUrl}" 
                             alt="${cameraName}" 
                             class="station-image"
                             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'400\\' height=\\'300\\'%3E%3Crect fill=\\'%23f0f0f0\\' width=\\'400\\' height=\\'300\\'/%3E%3Ctext fill=\\'%23999\\' x=\\'50%25\\' y=\\'50%25\\' text-anchor=\\'middle\\' dy=\\'.3em\\'%3E無法載入影像%3C/text%3E%3C/svg%3E'">
                        <div class="station-name">${cameraName}</div>
                        <div class="station-info">
                            <span>
                                <i class="fas fa-map-marker-alt"></i>
                                ${city} - ${district}
                            </span>
                            ${basin ? `
                            <span>
                                <i class="fas fa-water"></i>
                                ${basin}
                            </span>
                            ` : ''}
                            ${tributary ? `
                            <span>
                                <i class="fas fa-stream"></i>
                                ${tributary}
                            </span>
                            ` : ''}
                            <span>
                                <span class="status-badge ${status === '1' ? 'status-active' : 'status-inactive'}">
                                    ${status === '1' ? '● 運作中' : '○ 離線'}
                                </span>
                            </span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // 顯示監控站詳細資訊
        function showStationDetail(cameraid) {
            const station = waterCCTVManager.getStationById(cameraid);
            if (!station) return;
            
            const modal = document.getElementById('stationModal');
            const modalBody = document.getElementById('modalBody');
            
            modalBody.innerHTML = `
                <h2 style="color: #2c5aa0; margin-bottom: 20px;">
                    <i class="fas fa-video"></i> ${station.cameraname}
                </h2>
                
                <img src="${station.imageurl}" 
                     alt="${station.cameraname}" 
                     class="modal-image"
                     onerror="this.style.display='none'">
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div>
                        <h3 style="color: #666; font-size: 0.9em; margin-bottom: 10px;">基本資訊</h3>
                        <p><strong>監控站ID：</strong>${station.cameraid}</p>
                        <p><strong>站名：</strong>${station.videosurveillancestationname}</p>
                        <p><strong>狀態：</strong>
                            <span class="status-badge ${station.status === '1' ? 'status-active' : 'status-inactive'}">
                                ${station.status === '1' ? '● 運作中' : '○ 離線'}
                            </span>
                        </p>
                    </div>
                    
                    <div>
                        <h3 style="color: #666; font-size: 0.9em; margin-bottom: 10px;">地理位置</h3>
                        <p><strong>縣市：</strong>${station.countiesandcitieswherethemonitoringpointsarelocated}</p>
                        <p><strong>行政區：</strong>${station.administrativedistrictwherethemonitoringpointislocated}</p>
                        <p><strong>座標：</strong>${station.latitude_4326}, ${station.longitude_4326}</p>
                    </div>
                    
                    <div>
                        <h3 style="color: #666; font-size: 0.9em; margin-bottom: 10px;">水系資訊</h3>
                        <p><strong>流域：</strong>${station.basinname || '未分類'}</p>
                        <p><strong>支流：</strong>${station.tributary || '未分類'}</p>
                        <p><strong>河川代碼：</strong>${station.rivercode || '無'}</p>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px;">
                    <p style="margin: 0;"><strong>影像格式：</strong>${station.imageformat}</p>
                    <p style="margin: 10px 0 0 0;"><strong>座標系統：</strong>${station.coordinate}</p>
                </div>
                
                <div style="margin-top: 20px; text-align: center;">
                    <a href="${station.imageurl}" target="_blank" class="btn btn-primary">
                        <i class="fas fa-external-link-alt"></i> 開啟完整影像
                    </a>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        // 關閉 Modal
        function closeModal() {
            document.getElementById('stationModal').style.display = 'none';
        }

        // 點擊 Modal 外部關閉
        window.onclick = function(event) {
            const modal = document.getElementById('stationModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // 切換視圖
        function setView(view) {
            currentView = view;
            const buttons = document.querySelectorAll('.view-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.closest('.view-btn').classList.add('active');
            
            // 這裡可以添加列表視圖的邏輯
            if (view === 'list') {
                // 列表視圖待實作
                console.log('切換至列表視圖');
            }
        }

        // 頁面載入時初始化
        window.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
