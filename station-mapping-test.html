<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StationID å°ç…§è¡¨æ¸¬è©¦é é¢</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 { margin-bottom: 10px; font-size: 2em; }
        .header p { opacity: 0.9; }
        .content {
            padding: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-left: 4px solid #667eea;
            border-radius: 5px;
        }
        .test-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-section code {
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            display: block;
            margin: 10px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .input-group {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .input-group input {
            flex: 1;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }
        .input-group button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .input-group button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        .result {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border-left: 4px solid #10b981;
        }
        .result.error {
            border-left-color: #ef4444;
            color: #ef4444;
        }
        .result pre {
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-box .number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .stat-box .label {
            opacity: 0.9;
            font-size: 0.9em;
        }
        .success { color: #10b981; }
        .info { color: #3b82f6; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš‚ å°éµ StationID å°ç…§è¡¨æ¸¬è©¦</h1>
            <p>é©—è­‰è»Šç«™è³‡æ–™å’ŒæŸ¥è©¢åŠŸèƒ½</p>
        </div>

        <div class="content">
            <!-- çµ±è¨ˆè³‡è¨Š -->
            <div class="stats">
                <div class="stat-box">
                    <div class="number" id="stationCount">-</div>
                    <div class="label">åŒ…å«è»Šç«™æ•¸</div>
                </div>
                <div class="stat-box">
                    <div class="number" id="scriptLoaded">âŒ</div>
                    <div class="label">è…³æœ¬åŠ è¼‰</div>
                </div>
                <div class="stat-box">
                    <div class="number" id="functionCount">-</div>
                    <div class="label">å¯ç”¨å‡½æ•¸</div>
                </div>
            </div>

            <!-- æŸ¥è©¢å–®å€‹è»Šç«™ -->
            <div class="test-section">
                <h3>ğŸ“ æŸ¥è©¢å–®å€‹è»Šç«™è³‡è¨Š</h3>
                <div class="input-group">
                    <input type="text" id="stationCodeInput" placeholder="è¼¸å…¥è»Šç«™ä»£ç¢¼ï¼ˆå¦‚ï¼š1000ï¼‰" value="1000">
                    <button onclick="testGetStationData()">æŸ¥è©¢</button>
                </div>
                <div id="stationDataResult"></div>
            </div>

            <!-- æŸ¥è©¢è»Šç«™åç¨± -->
            <div class="test-section">
                <h3>ğŸ”¤ æŸ¥è©¢è»Šç«™åç¨±</h3>
                <div class="input-group">
                    <input type="text" id="stationCodeInput2" placeholder="è¼¸å…¥è»Šç«™ä»£ç¢¼" value="3300">
                    <button onclick="testGetStationName()">æŸ¥è©¢ä¸­æ–‡å</button>
                    <button onclick="testGetStationEName()">æŸ¥è©¢è‹±æ–‡å</button>
                </div>
                <div id="stationNameResult"></div>
            </div>

            <!-- æŸ¥è©¢GPSåº§æ¨™ -->
            <div class="test-section">
                <h3>ğŸ“¡ æŸ¥è©¢GPSåº§æ¨™</h3>
                <div class="input-group">
                    <input type="text" id="stationCodeInput3" placeholder="è¼¸å…¥è»Šç«™ä»£ç¢¼" value="4400">
                    <button onclick="testGetStationGPS()">æŸ¥è©¢åº§æ¨™</button>
                </div>
                <div id="gpsResult"></div>
            </div>

            <!-- æœç´¢è»Šç«™ -->
            <div class="test-section">
                <h3>ğŸ” æœç´¢è»Šç«™ï¼ˆæ¨¡ç³ŠæŸ¥è©¢ï¼‰</h3>
                <div class="input-group">
                    <input type="text" id="searchInput" placeholder="è¼¸å…¥æœç´¢è©ï¼ˆå¦‚ï¼šå°åŒ—ã€Taipeiï¼‰" value="å°åŒ—">
                    <button onclick="testSearchStations()">æœç´¢</button>
                </div>
                <div id="searchResult"></div>
            </div>

            <!-- é©—è­‰è»Šç«™ä»£ç¢¼ -->
            <div class="test-section">
                <h3>âœ“ é©—è­‰è»Šç«™ä»£ç¢¼æœ‰æ•ˆæ€§</h3>
                <div class="input-group">
                    <input type="text" id="validateInput" placeholder="è¼¸å…¥è»Šç«™ä»£ç¢¼é©—è­‰" value="1000">
                    <button onclick="testValidateStationCode()">é©—è­‰</button>
                </div>
                <div id="validateResult"></div>
            </div>

            <!-- ä¸»è¦è»Šç«™æ¸…å–® -->
            <div class="test-section">
                <h3>ğŸ“‹ ä¸»è¦è»Šç«™æ¸…å–®</h3>
                <button onclick="displayMainStations()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">é¡¯ç¤ºæ‰€æœ‰è»Šç«™</button>
                <div id="mainStationsResult"></div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥è»Šç«™ä»£ç¢¼æ˜ å°„è¡¨ -->
    <script src="assets/station-code-mapping.js"></script>

    <script>
        // åˆå§‹åŒ–
        function initTest() {
            try {
                // æª¢æŸ¥æ˜¯å¦åŠ è¼‰æˆåŠŸ
                if (typeof stationDataMap !== 'undefined') {
                    document.getElementById('scriptLoaded').textContent = 'âœ…';
                    document.getElementById('stationCount').textContent = Object.keys(stationDataMap).length;
                    
                    // è¨ˆç®—å¯ç”¨å‡½æ•¸æ•¸
                    let funcCount = 0;
                    if (typeof getStationIdFromCode === 'function') funcCount++;
                    if (typeof getStationData === 'function') funcCount++;
                    if (typeof getStationName === 'function') funcCount++;
                    if (typeof getStationEName === 'function') funcCount++;
                    if (typeof getStationGPS === 'function') funcCount++;
                    if (typeof getAllStations === 'function') funcCount++;
                    if (typeof isValidStationCode === 'function') funcCount++;
                    
                    document.getElementById('functionCount').textContent = funcCount;
                } else {
                    document.getElementById('scriptLoaded').textContent = 'âŒ';
                }
            } catch (e) {
                console.error('åˆå§‹åŒ–éŒ¯èª¤:', e);
            }
        }

        // æŸ¥è©¢å–®å€‹è»Šç«™
        function testGetStationData() {
            const code = document.getElementById('stationCodeInput').value;
            const result = document.getElementById('stationDataResult');
            
            try {
                const station = getStationData(code);
                if (station) {
                    result.innerHTML = `<div class="result">
                        <strong class="success">âœ“ æ‰¾åˆ°è»Šç«™è³‡è¨Š</strong>
                        <pre>${JSON.stringify(station, null, 2)}</pre>
                    </div>`;
                } else {
                    result.innerHTML = `<div class="result error">
                        <strong>âœ— æœªæ‰¾åˆ°è»Šç«™ä»£ç¢¼: ${code}</strong>
                    </div>`;
                }
            } catch (e) {
                result.innerHTML = `<div class="result error">
                    <strong>âœ— éŒ¯èª¤:</strong> ${e.message}
                </div>`;
            }
        }

        // æŸ¥è©¢è»Šç«™åç¨±
        function testGetStationName() {
            const code = document.getElementById('stationCodeInput2').value;
            const result = document.getElementById('stationNameResult');
            
            try {
                const name = getStationName(code);
                result.innerHTML = `<div class="result">
                    <strong class="success">âœ“ ä¸­æ–‡åç¨±: ${name || '(æœªæ‰¾åˆ°)'}</strong>
                </div>`;
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // æŸ¥è©¢è‹±æ–‡å
        function testGetStationEName() {
            const code = document.getElementById('stationCodeInput2').value;
            const result = document.getElementById('stationNameResult');
            
            try {
                const ename = getStationEName(code);
                result.innerHTML = `<div class="result">
                    <strong class="success">âœ“ è‹±æ–‡åç¨±: ${ename || '(æœªæ‰¾åˆ°)'}</strong>
                </div>`;
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // æŸ¥è©¢GPSåº§æ¨™
        function testGetStationGPS() {
            const code = document.getElementById('stationCodeInput3').value;
            const result = document.getElementById('gpsResult');
            
            try {
                const gps = getStationGPS(code);
                const station = getStationData(code);
                
                if (gps) {
                    const [lat, lon] = gps.split(' ').map(parseFloat);
                    result.innerHTML = `<div class="result">
                        <strong class="success">âœ“ GPSåº§æ¨™æ‰¾åˆ°</strong>
                        <pre>
è»Šç«™: ${station.name} (${station.ename})
åº§æ¨™: ${gps}
ç·¯åº¦: ${lat}
ç¶“åº¦: ${lon}

Google Maps: <a href="https://maps.google.com/?q=${lat},${lon}" target="_blank">æŸ¥çœ‹åœ°åœ–</a>
                        </pre>
                    </div>`;
                } else {
                    result.innerHTML = `<div class="result error">âœ— æœªæ‰¾åˆ°åº§æ¨™</div>`;
                }
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // æœç´¢è»Šç«™
        function testSearchStations() {
            const search = document.getElementById('searchInput').value;
            const result = document.getElementById('searchResult');
            
            try {
                const stations = getAllStations(search);
                if (stations.length > 0) {
                    let html = `<div class="result">
                        <strong class="success">âœ“ æ‰¾åˆ° ${stations.length} å€‹è»Šç«™</strong>
                        <pre>`;
                    
                    stations.slice(0, 10).forEach(station => {
                        html += `${station.name} (${station.ename}) - ${station.stationCode}\n`;
                    });
                    
                    if (stations.length > 10) {
                        html += `\n... é‚„æœ‰ ${stations.length - 10} å€‹ ...`;
                    }
                    
                    html += `</pre></div>`;
                    result.innerHTML = html;
                } else {
                    result.innerHTML = `<div class="result error">âœ— æœªæ‰¾åˆ°åŒ¹é…çš„è»Šç«™</div>`;
                }
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // é©—è­‰è»Šç«™ä»£ç¢¼
        function testValidateStationCode() {
            const code = document.getElementById('validateInput').value;
            const result = document.getElementById('validateResult');
            
            try {
                const valid = isValidStationCode(code);
                result.innerHTML = `<div class="result ${valid ? '' : 'error'}">
                    ${valid ? 'âœ“ <strong class="success">æœ‰æ•ˆçš„è»Šç«™ä»£ç¢¼</strong>' : 'âœ— <strong>ç„¡æ•ˆçš„è»Šç«™ä»£ç¢¼</strong>'}
                </div>`;
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // é¡¯ç¤ºä¸»è¦è»Šç«™
        function displayMainStations() {
            const result = document.getElementById('mainStationsResult');
            
            try {
                const mainCodes = ["0900", "1000", "1020", "1210", "3300", "4080", "4220", "4400", "5000", "6000", "7000"];
                let html = `<div class="result">
                    <strong class="success">âœ“ ä¸»è¦è»Šç«™åˆ—è¡¨</strong>
                    <pre>
è™Ÿç¢¼ | ä»£ç¢¼ | ä¸­æ–‡åç¨± | è‹±æ–‡åç¨±
----|------|--------|--------
`;
                
                mainCodes.forEach((code, idx) => {
                    const station = getStationData(code);
                    if (station) {
                        html += `${(idx+1).toString().padStart(2, ' ')} | ${code} | ${station.name.padEnd(6, ' ')} | ${station.ename}\n`;
                    }
                });
                
                html += `</pre></div>`;
                result.innerHTML = html;
            } catch (e) {
                result.innerHTML = `<div class="result error">éŒ¯èª¤: ${e.message}</div>`;
            }
        }

        // é é¢åŠ è¼‰å®Œæˆå¾Œåˆå§‹åŒ–
        window.addEventListener('load', initTest);
    </script>
</body>
</html>
