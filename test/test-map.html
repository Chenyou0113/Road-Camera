<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°åœ–æ¸¬è©¦</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #f0f0f0; }
        .container { max-width: 1200px; margin: 20px auto; padding: 20px; }
        h1 { color: #333; margin-bottom: 20px; }
        #map { 
            width: 100%;
            height: 600px; 
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #ccc;
        }
        .info-box {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .info-box h2 { color: #1e40af; margin-bottom: 10px; }
        .info-box p { margin: 5px 0; color: #666; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ åœ°åœ–é¡¯ç¤ºæ¸¬è©¦</h1>
        
        <div class="info-box">
            <h2>è¼‰å…¥ç‹€æ…‹</h2>
            <div id="status"></div>
        </div>

        <div id="map"></div>

        <div class="info-box">
            <h2>æ¸¬è©¦çµæœ</h2>
            <div id="result"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const statusDiv = document.getElementById('status');
        const resultDiv = document.getElementById('result');

        function addStatus(type, message) {
            const p = document.createElement('p');
            p.className = `status ${type}`;
            p.textContent = message;
            statusDiv.appendChild(p);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // æª¢æŸ¥ Leaflet
        if (typeof L !== 'undefined') {
            addStatus('success', 'âœ… Leaflet å·²æˆåŠŸè¼‰å…¥');
        } else {
            addStatus('error', 'âŒ Leaflet æœªè¼‰å…¥');
            resultDiv.innerHTML = '<p style="color: red;">Leaflet è³‡æºè¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²éš›ç¶²è·¯é€£æ¥ã€‚</p>';
        }

        // åˆå§‹åŒ–åœ°åœ–
        try {
            const map = L.map('map').setView([23.5, 121], 7);
            addStatus('success', 'âœ… åœ°åœ–å®¹å™¨åˆå§‹åŒ–æˆåŠŸ');

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors',
                maxZoom: 19
            }).addTo(map);
            addStatus('success', 'âœ… åœ°åœ–åœ–å±¤å·²æ·»åŠ ');

            // æ·»åŠ æ¸¬è©¦æ¨™è¨˜
            const testMarkers = [
                { lat: 23.5, lng: 121, name: 'å°ç£ä¸­å¿ƒ' },
                { lat: 25.0, lng: 121.5, name: 'åŸºéš†' },
                { lat: 25.15, lng: 121.44, name: 'å°åŒ—' },
                { lat: 24.8, lng: 120.97, name: 'æ–°ç«¹' },
                { lat: 24.1, lng: 120.67, name: 'å°ä¸­' },
                { lat: 23.56, lng: 120.29, name: 'å½°åŒ–' },
                { lat: 23.03, lng: 120.2, name: 'å˜‰ç¾©' },
                { lat: 22.63, lng: 120.25, name: 'é«˜é›„' },
                { lat: 22.0, lng: 120.5, name: 'å±æ±' }
            ];

            testMarkers.forEach((marker, idx) => {
                const circle = L.circleMarker([marker.lat, marker.lng], {
                    radius: 8,
                    fillColor: '#1e40af',
                    color: '#fff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.8
                });

                circle.bindPopup(`<strong>${marker.name}</strong><br>åº§æ¨™: ${marker.lat.toFixed(4)}, ${marker.lng.toFixed(4)}`);
                circle.bindTooltip(marker.name);
                circle.addTo(map);
            });

            addStatus('success', `âœ… å·²æ·»åŠ  ${testMarkers.length} å€‹æ¸¬è©¦æ¨™è¨˜`);

            // è‡ªå‹•èª¿æ•´è¦–åœ–
            map.fitBounds([
                [22, 120],
                [25.2, 121.6]
            ]);
            addStatus('success', 'âœ… åœ°åœ–è¦–åœ–å·²è‡ªå‹•èª¿æ•´');

            resultDiv.innerHTML = `
                <p style="color: green;"><strong>âœ… æ¸¬è©¦æˆåŠŸï¼</strong></p>
                <p>åœ°åœ–å·²æ­£ç¢ºåˆå§‹åŒ–ï¼Œè«‹é»æ“Šæ¨™è¨˜æŸ¥çœ‹å½ˆçª—ã€‚</p>
                <ul>
                    <li>âœ… Leaflet åº«å·²è¼‰å…¥</li>
                    <li>âœ… åœ°åœ–å®¹å™¨å·²åˆå§‹åŒ–</li>
                    <li>âœ… åœ°åœ–åœ–å±¤å·²æ·»åŠ </li>
                    <li>âœ… æ¸¬è©¦æ¨™è¨˜å·²é¡¯ç¤º</li>
                    <li>âœ… äº¤äº’åŠŸèƒ½æ­£å¸¸</li>
                </ul>
                <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                    <strong>å»ºè­°ï¼š</strong>å¦‚æœé€™å€‹é é¢èƒ½æ­£å¸¸é¡¯ç¤ºåœ°åœ–ï¼Œ
                    ä½† highway.html ä¸èƒ½ï¼Œå¯èƒ½æ˜¯ CameraMapManager é¡æœ‰å•é¡Œæˆ–è³‡æ–™æ ¼å¼ä¸åŒ¹é…ã€‚
                </p>
            `;

        } catch (error) {
            addStatus('error', `âŒ åˆå§‹åŒ–å¤±æ•—: ${error.message}`);
            resultDiv.innerHTML = `<p style="color: red;"><strong>éŒ¯èª¤ï¼š</strong> ${error.message}</p>`;
            console.error('è©³ç´°éŒ¯èª¤:', error);
        }
    </script>
</body>
</html>
